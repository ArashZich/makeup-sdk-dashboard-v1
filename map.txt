# 📋 خلاصه تمام تغییرات API ها

## 🆕 API های جدید اضافه شده:

### 1️⃣ **دریافت ویژگی‌های SDK کاربر** 
**📍 مسیر:** `GET /users/me/sdk-features`
- **دسترسی:** 👤 کاربر عادی
- **محل:** اضافه شده به `users-service.ts` و `useUsers.ts`
- **هوک جدید:** `useUserSdkFeatures()`
- **کاربرد:** دریافت ویژگی‌های مجاز SDK بر اساس بسته فعال

### 2️⃣ **آمار درآمد بر اساس پلتفرم**
**📍 مسیر:** `GET /payments/stats/revenue`
- **دسترسی:** 👨‍💼 فقط ادمین
- **فایل‌های جدید:** `revenue-stats.types.ts`, `revenue-stats-service.ts`, `useRevenueStats.ts`
- **کاربرد:** گزارش درآمد تفکیک شده بر اساس پلتفرم‌ها

### 3️⃣ **آپلود تصویر** 
**📍 مسیر:** `POST /upload` (baseURL متفاوت)
- **دسترسی:** 👤 کاربر عادی
- **فایل‌های جدید:** `upload-axios.ts`, `upload.types.ts`, `upload-service.ts`, `useUpload.ts`
- **ویژگی‌ها:** Progress tracking, Cancel upload, File validation

---

## 🔄 API های موجود که آپدیت شدند:

### 4️⃣ **Plans API - اضافه شدن targetPlatforms**
**📍 مسیر:** `GET /plans/public`, `GET /plans`
- **دسترسی:** 👤 کاربر عادی + 👨‍💼 ادمین
- **تغییرات:**
  - فیلد جدید: `targetPlatforms: TargetPlatform[]`
  - فیلتر خودکار بر اساس پلتفرم کاربر
  - Helper functions برای فیلتر پلن‌ها

### 5️⃣ **Packages API - اضافه شدن purchasePlatform**
**📍 مسیر:** `GET /packages/me`, `GET /packages`, `POST /packages`
- **دسترسی:** 👤 کاربر عادی + 👨‍💼 ادمین
- **تغییرات:**
  - فیلد جدید: `purchasePlatform: PurchasePlatform`
  - فیلتر جدید در PackageFilters
  - Helper functions برای آنالیتیکس پلتفرم

---

## 📊 تفکیک دسترسی‌ها:

### 👤 **برای کاربران عادی:**
1. **SDK Features** - دریافت ویژگی‌های مجاز
2. **Plans** - مشاهده پلن‌های مناسب پلتفرمشان
3. **Packages** - مدیریت بسته‌های خودشان
4. **Upload** - آپلود تصاویر با progress tracking

### 👨‍💼 **برای ادمین:**
1. **Revenue Stats** - گزارش کامل درآمد بر اساس پلتفرم
2. **Plans Management** - مدیریت پلن‌ها با تنظیم target platforms
3. **Packages Management** - ایجاد و مدیریت بسته‌ها با تعیین platform
4. **Advanced Analytics** - آمار پیشرفته پلتفرم‌ها

---

## 🆕 Types و Helper Functions اضافه شده:

### **Types جدید:**
- `TargetPlatform` = `"all" | "normal" | "divar" | "torob" | "basalam"`
- `PurchasePlatform` = `"normal" | "divar" | "torob" | "basalam"`
- `RevenuePlatform` = `"normal" | "divar" | "torob" | "basalam"`
- `ImageType` = `"avatar" | "product" | "color" | "general"`

### **Helper Functions مهم:**
- `filterPlansByPlatform()` - فیلتر پلن‌ها
- `groupPackagesByPlatform()` - گروه‌بندی بسته‌ها
- `calculatePlatformPercentages()` - درصد درآمد پلتفرم‌ها
- `getPlatformAnalytics()` - آمار کامل
- `validateFile()` - اعتبارسنجی فایل آپلود

---

## 🔧 تنظیمات Environment Variables:

```env
# API اصلی (موجود)
NEXT_PUBLIC_API_URL=http://localhost:3000/api/v1

# API آپلود (جدید)
NEXT_PUBLIC_UPLOAD_API_URL=http://localhost:5001/api/v1
```

---

## 🎯 آماده برای UI:

حالا همه API ها آماده هستند و می‌تونیم شروع کنیم به پیاده‌سازی UI:

1. **صفحه SDK Features** - نمایش ویژگی‌های مجاز کاربر
2. **فیلتر پلن‌ها** - بر اساس پلتفرم کاربر  
3. **آپلود تصاویر** - با progress bar و cancel
4. **داشبورد ادمین** - آمار درآمد و پلتفرم‌ها
5. **مدیریت بسته‌ها** - با نمایش platform مبدا

کدوم قسمت رو اول پیاده‌سازی کنیم؟